{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AI-BOM Inspector Report",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "generated_at",
    "total_risk",
    "stack_risk_score",
    "risk_breakdown",
    "risk_settings",
    "dependencies",
    "models"
  ],
  "properties": {
    "generated_at": { "type": "string", "format": "date-time" },
    "ai_summary": { "type": ["string", "null"] },
    "total_risk": { "type": "integer", "minimum": 0 },
    "stack_risk_score": { "type": "integer", "minimum": 0, "maximum": 100 },
    "risk_breakdown": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "unpinned_deps": { "type": "integer", "minimum": 0 },
        "unverified_sources": { "type": "integer", "minimum": 0 },
        "unknown_licenses": { "type": "integer", "minimum": 0 },
        "stale_models": { "type": "integer", "minimum": 0 },
        "cves": { "type": "integer", "minimum": 0 }
      }
    },
    "risk_settings": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "max_score": { "type": "integer" },
        "severity_penalties": {
          "type": "object",
          "additionalProperties": { "type": "integer" }
        },
        "governance_penalty": { "type": "integer" },
        "cve_penalty": { "type": "integer" }
      }
    },
    "dependencies": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["name", "version", "source", "license", "license_category", "issues", "issue_details", "risk", "trust_signals", "trust_score"],
        "properties": {
          "name": { "type": "string" },
          "version": { "type": "string" },
          "source": { "type": "string" },
          "license": { "type": "string" },
          "license_category": { "type": "string" },
          "issues": {
            "type": "array",
            "items": { "type": "string" }
          },
          "issue_details": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": false,
              "required": ["message", "severity"],
              "properties": {
                "message": { "type": "string" },
                "severity": { "type": "string" },
                "code": { "type": ["string", "null"] }
              }
            }
          },
          "risk": { "type": "integer" },
          "trust_signals": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": false,
              "required": ["message", "severity"],
              "properties": {
                "message": { "type": "string" },
                "severity": { "type": "string" },
                "code": { "type": ["string", "null"] }
              }
            }
          },
          "trust_score": { "type": "integer" }
        }
      }
    },
    "models": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["id", "source", "license", "license_category", "last_updated", "issues", "issue_details", "risk", "trust_signals", "trust_score"],
        "properties": {
          "id": { "type": "string" },
          "source": { "type": "string" },
          "license": { "type": "string" },
          "license_category": { "type": "string" },
          "last_updated": { "type": "string" },
          "issues": {
            "type": "array",
            "items": { "type": "string" }
          },
          "issue_details": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": false,
              "required": ["message", "severity"],
              "properties": {
                "message": { "type": "string" },
                "severity": { "type": "string" },
                "code": { "type": ["string", "null"] }
              }
            }
          },
          "risk": { "type": "integer" },
          "trust_signals": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": false,
              "required": ["message", "severity"],
              "properties": {
                "message": { "type": "string" },
                "severity": { "type": "string" },
                "code": { "type": ["string", "null"] }
              }
            }
          },
          "trust_score": { "type": "integer" }
        }
      }
    },
    "report_id": { "type": "string" },
    "rendered_at": { "type": "string", "format": "date-time" }
  }
}
